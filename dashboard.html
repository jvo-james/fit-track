<!DOCTYPE html>
<html lang="en">
<head>
 
 <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FitTrack | Dashboard</title>
  <!-- Google Fonts & FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <script defer src="https://kit.fontawesome.com/a2e8f1b6b1.js"></script>
   <!-- Google Fonts & FontAwesome -->
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"/>
  <script defer src="https://kit.fontawesome.com/a2e8f1b6b1.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="storage.js"></script>


  <style>
  :root {
    --bg: #000;
    --gold: #ff9800;
    --white: #fff;
    --font-base: 'Raleway', sans-serif;
    --font-head: 'Poppins', sans-serif;
    --transition: .3s ease;
    --sidebar-w: 80px;
    --mobile-sidebar-w: 200px;
    --header-z: 200;
    --overlay-z: 90;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    display:flex; min-height:100vh;
    background:var(--bg); color:var(--white);
    font-family:var(--font-base); overflow-x:hidden;
  }
  a { color:inherit; text-decoration:none; }
  button { font-family:var(--font-head); background:transparent; border:none; color:var(--white); cursor:pointer; transition:var(--transition); }

  /* ─── OVERLAY ───────────────── */
  #overlay {
    position:fixed; inset:0; background:rgba(0,0,0,0.5);
    opacity:0; visibility:hidden; transition:opacity var(--transition);
    z-index:var(--overlay-z);
  }
  #overlay.active { opacity:1; visibility:visible; }

  /* ─── SIDEBAR ───────────────── */
  aside.sidebar {
    width:var(--sidebar-w); background:rgba(0,0,0,0.9); border-right:2px solid var(--gold);
    display:flex; flex-direction:column; align-items:center;
    padding-top:1rem; position:sticky; top:0; height:100vh;
    transition:transform var(--transition); z-index:var(--sidebar-z);
  }
  aside.sidebar.open { transform:translateX(0); }
  .sidebar-close { display:none; }
  .sidebar .logo { font-size:1.6rem; color:var(--gold); margin-bottom:2rem; }
  .sidebar .menu-item {
    width:100%; padding:.8rem 0;
    display:flex; flex-direction:column; align-items:center; gap:.2rem;
    font-size:.75rem; color:var(--white);
  }
  .sidebar .menu-item i { font-size:1.2rem; }
  .sidebar .menu-item.active,
  .sidebar .menu-item:hover { background:rgba(255,152,0,0.2); }
  .sidebar-close { display:block; position:absolute; top:1rem; right:1rem; font-size:1.5rem; }

  /* ─── HEADER ───────────────── */
  header {
    display:flex; align-items:center; justify-content:space-between;
    padding:1rem 1.5rem; background:rgba(0,0,0,0.9);
    border-bottom:2px solid var(--gold);
    position:sticky; top:0; left:0; right:0; z-index:var(--header-z);
  }
  .hamburger, .profile-btn { display:none; color:var(--white); }
  header h1 {
    flex:1; text-align:center;
    font-size:1.5rem; color:var(--white);
  }
  .header-left { display:flex; align-items:center; gap:1rem; }
  .header-left .logo-text { font-size:1.4rem; font-weight:700; display:flex; align-items:center; gap:.5rem; }
  .header-right { display:flex; align-items:center; gap:1rem; }
  .header-right .icon-btn { font-size:1.2rem; padding:.3rem; border-radius:50%; background:rgba(255,152,0,0.2); }

  /* ─── MAIN LAYOUT ───────────────── */
  .main { flex:1; display:flex; flex-direction:column; }
  .content { padding:1rem 1.5rem; flex:1; overflow-y:auto; }

  /* ─── QUICK SUMMARY ───────────────── */
  .summary-grid {
    display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
    gap:1rem; margin-bottom:1.5rem;
  }
  .summary-card {
    background:rgba(255,255,255,0.05); border-radius:8px;
    padding:1rem; text-align:center;
    transition:var(--transition);
  }
  .summary-card:hover { background:rgba(255,255,255,0.1); }
  .summary-card i { font-size:1.4rem; color:var(--gold); margin-bottom:.4rem; }
  .summary-card .value { font-size:1.2rem; margin:0.3rem 0; }
  .summary-card .label { font-size:.85rem; opacity:.8; }

  /* ─── UPCOMING & RECOMMENDED ───────────────── */
  .upcoming, .recommended {
    margin-bottom:1.5rem;
  }
  .upcoming .card-list,
  .recommended .card-list {
    display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
    gap:1rem;
  }
  .upcoming .card, .recommended .card {
    background:rgba(255,255,255,0.05); border-radius:8px;
    padding:1rem; display:flex; flex-direction:column;
  }
  .card h4 { margin-bottom:.5rem; }
  .card p { flex:1; font-size:.9rem; opacity:.8; }
  .card button { margin-top:.5rem; background:var(--gold); color:var(--bg); padding:.4rem; border-radius:6px; }

  /* ─── CHARTS ───────────────── */
  .charts { display:grid; gap:1rem; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); margin-bottom:1.5rem; }
  .chart-card {
    background:rgba(255,255,255,0.05); border-radius:8px;
    padding:1rem;
  }
  .chart-card h3 { display:flex; align-items:center; gap:.5rem; margin-bottom:.75rem; color:var(--gold); }
  .chart-card canvas { width:100% !important; height:200px !important; }

  /* ─── ACTION SECTIONS ───────────────── */
  .actions-grid {
    display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:1rem; margin-bottom:1.5rem;
  }
  .action-card {
    background:rgba(255,255,255,0.05); border-radius:8px;
    padding:1rem; display:flex; flex-direction:column; justify-content:space-between;
  }
  .action-card h3 { font-size:1rem; margin-bottom:.5rem; }
  .action-card ul { list-style:none; padding-left:1rem; font-size:.9rem; opacity:.8; flex:1; }
  .action-card ul li { margin-bottom:.3rem; }
  .action-card button { margin-top:.5rem; background:var(--gold); color:var(--bg); padding:.4rem; border-radius:6px; }

  /* ─── FOOTER ───────────────── */
  footer { text-align:center; padding:1rem 0; border-top:1px solid rgba(255,255,255,0.2); font-size:.9rem; opacity:.6; }

  /* ─── RESPONSIVE ───────────────── */
  @media (max-width:600px) {
    aside.sidebar {
      position:fixed; top:0; bottom:0; left:0;
      width:var(--mobile-sidebar-w); transform:translateX(-100%);
    }
    aside.sidebar.open { transform:translateX(0); }
    .sidebar-close { display:block; }
    header { padding:.8rem 1rem; }
    .hamburger, .profile-btn {
      display:block; position:absolute; top:50%; transform:translateY(-50%);
      font-size:1.2rem; background:transparent; border:none; z-index:var(--header-z);
    }
    .hamburger { left:1rem; }
    .profile-btn { right:1rem; }
    header h1 { margin:0 auto; font-size:1.1rem; }
    .header-right { display:none; }
    .content { padding:.8rem 1rem; }
    .charts { grid-template-columns:1fr; }
    .actions-grid { grid-template-columns:1fr; }
    body { padding-bottom: env(safe-area-inset-bottom); }
  }
  </style>
</head>
<body>
  <div id="overlay"></div>

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar">
    <button id="sidebar-close" class="sidebar-close">&times;</button>
    <div class="logo"><i class="fas fa-heartbeat"></i></div>
    <a href="dashboard.html" class="menu-item active"><i class="fas fa-tachometer-alt"></i><span>Dashboard</span></a>
    <a href="log.html"       class="menu-item"><i class="fas fa-pen"></i><span>Log</span></a>
    <a href="workouts.html"  class="menu-item"><i class="fas fa-dumbbell"></i><span>Workouts</span></a>
    <a href="leaderboard.html" class="menu-item"><i class="fas fa-trophy"></i><span>Board</span></a>
    <button class="menu-item profile-menu"><i id="side-avatar" class="fas fa-user-circle avatar"></i><span>Profile</span></button>
    <a href="signout.html"   class="menu-item sign-out"><i class="fas fa-sign-out-alt"></i><span>Sign Out</span></a>
  </aside>

  <div class="main">
    <!-- HEADER -->
    <header>
      <button id="hamburger" class="hamburger"><i class="fas fa-bars"></i></button>
      <div class="header-left">
        <i class="fas fa-chart-pie" style="color:var(--gold);font-size:1.4rem;"></i>
        <span class="logo-text">Dashboard</span>
      </div>
      <div class="header-right">
        <input type="text" placeholder="Search…" style="padding:.4rem .8rem; border-radius:6px; border:1px solid rgba(255,255,255,0.3); background:rgba(255,255,255,0.05); color:var(--white); font-size:.9rem;"/>
        <button class="icon-btn"><i class="fas fa-bell"></i></button>
        <button id="profile-btn" class="profile-btn"><i class="fas fa-user-circle"></i></button>
      </div>
    </header>

    <div class="content">
      <!-- 1) Quick summary -->
      <section class="summary-grid">
        <div class="summary-card"><i class="fas fa-dumbbell"></i><div class="value" id="sum-workouts">0</div><div class="label">This Month</div></div>
        <div class="summary-card"><i class="fas fa-route"></i><div class="value" id="sum-distance">0 km</div><div class="label">Distance</div></div>
        <div class="summary-card"><i class="fas fa-fire"></i><div class="value" id="sum-calories">0</div><div class="label">Calories</div></div>
        <div class="summary-card"><i class="fas fa-calendar-day"></i><div class="value" id="sum-days">0</div><div class="label">Active Days</div></div>
      </section>

      <!-- 2) Upcoming Workout -->
      <section class="upcoming">
        <h3><i class="fas fa-clock"></i> Upcoming Workout</h3>
        <div class="card-list">
          <div class="card">
            <h4 id="next-title">Loading…</h4>
            <p id="next-desc">…</p>
            <button id="next-btn">Start Now</button>
          </div>
        </div>
      </section>

      <!-- 3) Recommended Routines -->
      <section class="recommended">
        <h3><i class="fas fa-lightbulb"></i> Recommended Routines</h3>
        <div class="card-list" id="reco-list">
          <!-- js injected -->
        </div>
      </section>

      <!-- 4) Charts -->
      <section class="charts">
        <div class="chart-card"><h3><i class="fas fa-chart-line"></i> Weekly Activity</h3><canvas id="chart-activity"></canvas></div>
        <div class="chart-card"><h3><i class="fas fa-chart-pie"></i> Workout Breakdown</h3><canvas id="chart-distrib"></canvas></div>
      </section>

      <!-- 5) Action panels (Challenges, Leaderboard, Feed) -->
      <section class="actions-grid">
        <div class="action-card">
          <h3><i class="fas fa-flag-checkered"></i> My Challenges</h3>
          <ul id="act-challenges">
            <!-- js -->
          </ul>
          <button onclick="location.href='challenges.html'">View All</button>
        </div>
        <div class="action-card">
          <h3><i class="fas fa-trophy"></i> Leaderboard</h3>
          <ul id="act-leaderboard">
            <!-- js -->
          </ul>
          <button onclick="location.href='leaderboard.html'">See Rankings</button>
        </div>
        <div class="action-card">
          <h3><i class="fas fa-users"></i> Community Feed</h3>
          <ul id="act-feed">
            <!-- js -->
          </ul>
          <button onclick="location.href='community.html'">More Posts</button>
        </div>
      </section>

      <!-- 6) Footer quick link -->
      <footer>
        &copy; 2025 FitTrack • <a href="profile.html">My Profile</a> • <a href="help.html">Help Center</a>
      </footer>
    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded',()=>{
    // pull data
    const workouts = JSON.parse(localStorage.getItem('ft_activities')||'[]'),
          plans    = JSON.parse(localStorage.getItem('ft_plans')||'[]'),
          qaList   = JSON.parse(localStorage.getItem('ft_challenges')||'[]'),
          leaderboard = JSON.parse(localStorage.getItem('ft_leaderboard')||'[]'),
          feed     = JSON.parse(localStorage.getItem('ft_feed')||'[]'),
          routines = [ // same sample as your workouts.html
            {id:1,title:'Full-Body HIIT',desc:'Fast-paced intervals to torch calories.'},
            {id:2,title:'Morning Yoga Flow',desc:'Gentle wake-up sequences.'},
            {id:3,title:'Upper Body Strength',desc:'Build power in arms & chest.'}
          ];

    // summary
    const thisMonth = workouts.filter(a=>{
      const d=new Date(a.date), now=new Date();
      return d.getMonth()===now.getMonth()&&d.getFullYear()===now.getFullYear();
    }).length;
    const dist = workouts.reduce((s,a)=>s+(parseFloat(a.distance)||0),0).toFixed(1);
    const cal = workouts.reduce((s,a)=>s+(parseFloat(a.calories)||0),0);
    const days = [...new Set(workouts.map(a=>a.date))].length;
    document.getElementById('sum-workouts').textContent=thisMonth;
    document.getElementById('sum-distance').textContent=dist+' km';
    document.getElementById('sum-calories').textContent=cal;
    document.getElementById('sum-days').textContent=days;

    // upcoming = first saved plan
    const next = plans.length
      ? routines.find(r=>r.id===plans[0])
      : routines[0];
    document.getElementById('next-title').textContent=next.title;
    document.getElementById('next-desc').textContent=next.desc;
    document.getElementById('next-btn').onclick=_=>{
      localStorage.setItem('ft_activities',JSON.stringify([{ date:new Date().toISOString().slice(0,10), type:next.title, duration:30 }].concat(workouts)));
      location.reload();
    };

    // recommended
    const reco = document.getElementById('reco-list');
    routines.slice(1).forEach(r=>{
      const d=document.createElement('div'); d.className='card';
      d.innerHTML=`<h4>${r.title}</h4><p>${r.desc}</p><button onclick="start('${r.title}')">Try It</button>`;
      reco.append(d);
    });
    window.start = t=>{ alert('Starting '+t); };

    // build small arrays for charts
    const last7=Array.from({length:7}).map((_,i)=>{
      const d=new Date(); d.setDate(d.getDate()-(6-i));
      return d.toISOString().slice(5,10);
    });
    const actData = last7.map(day=>
      workouts.filter(a=>a.date.slice(5)===day).reduce((s,a)=>s+(+a.duration||0),0)
    );
    const typeDist = ['Cardio','Strength','Yoga','Other'].map(cat=>
      workouts.filter(a=>a.type.includes(cat)).length
    );

    // line
    new Chart(document.getElementById('chart-activity'),{
      type:'line',
      data:{labels:last7,datasets:[{data:actData,label:'Mins',borderColor:'#ff9800',backgroundColor:'rgba(255,152,0,0.2)',fill:true,tension:.3}]},
      options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}}}
    });
    // pie
    new Chart(document.getElementById('chart-distrib'),{
      type:'pie',
      data:{labels:['Cardio','Strength','Yoga','Other'],datasets:[{data:typeDist,backgroundColor:['#ff9800','#ff5722','#4caf50','#03a9f4']}]},
      options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'bottom'}}}
    });

    // action grids
    const chUL=document.getElementById('act-challenges');
    qaList.forEach(c=>chUL.innerHTML+=`<li>${c.text||c.q}</li>`);

    const lbOL=document.getElementById('act-leaderboard');
    leaderboard.forEach(u=>lbOL.innerHTML+=`<li>${u.name}: ${u.score}</li>`);

    const fdUL=document.getElementById('act-feed');
    feed.forEach(p=>fdUL.innerHTML+=`<li>${p}</li>`);

    // replace avatars
    const prof = JSON.parse(localStorage.getItem('ft_profile')||'{}');
    ['top-avatar','side-avatar'].forEach(id=>{
      const el=document.getElementById(id);
      if(el && prof.avatar){
        const img=new Image(); img.src=prof.avatar; img.className='avatar';
        el.replaceWith(img);
      }
    });

    // sidebar toggle
    document.getElementById('hamburger').onclick=_=>{
      document.querySelector('aside.sidebar').classList.add('open');
      document.getElementById('overlay').classList.add('active');
    };
    document.getElementById('sidebar-close').onclick=
    document.getElementById('overlay').onclick=_=>{
      document.querySelector('aside.sidebar').classList.remove('open');
      document.getElementById('overlay').classList.remove('active');
    };
    // profile nav
    document.getElementById('profile-btn').onclick=_=>location.href='profile.html';
  });
  </script>
</body>
</html>
